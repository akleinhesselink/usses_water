points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Drought")
# pca_scores <- scores(tmp_rda)
# plot(pca_scores[,1],
#      pca_scores[,2],
#      pch=21,
#      bg=as.numeric(tmp$Treatment),
#      ylab="PCA1", xlab=("PCA2"),
#      main = doyr)
}
mycol <- RColorBrewer::brewer.pal(3,"Set2")
png(paste0(figure_path,"sppcomp_nmds.png"), width=6, height = 5, units = "in", res = 120)
par(mfrow=c(2,3))
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "raup")
tmp_dist <- vegdist(tmp[3:ncol(tmp)], method = "raup")
tmp_clust <- hclust(tmp_dist, method = "average")
mds.fig <- ordiplot(tmp_rda, type = "none", main = doyr)
# plot just the samples, colour by habitat, pch=19 means plot a circle
ordicluster(tmp_rda, tmp_clust, col = "gray")
points(mds.fig, "sites", pch = 19, col = mycol[1], select = tmp$Treatment == "Control")
points(mds.fig, "sites", pch = 19, col = mycol[2], select = tmp$Treatment == "Irrigation")
points(mds.fig, "sites", pch = 19, col = mycol[3], select = tmp$Treatment == "Drought")
points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Control")
points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Irrigation")
points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Drought")
# pca_scores <- scores(tmp_rda)
# plot(pca_scores[,1],
#      pca_scores[,2],
#      pch=21,
#      bg=as.numeric(tmp$Treatment),
#      ylab="PCA1", xlab=("PCA2"),
#      main = doyr)
}
dev.off()
mycol <- RColorBrewer::brewer.pal(3,"Set2")
png(paste0(figure_path,"sppcomp_nmds.png"), width=6, height = 4, units = "in", res = 120)
par(mfrow=c(2,3))
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "raup")
tmp_dist <- vegdist(tmp[3:ncol(tmp)], method = "raup")
tmp_clust <- hclust(tmp_dist, method = "average")
mds.fig <- ordiplot(tmp_rda, type = "none", main = doyr)
# plot just the samples, colour by habitat, pch=19 means plot a circle
ordicluster(tmp_rda, tmp_clust, col = "gray")
points(mds.fig, "sites", pch = 19, col = mycol[1], select = tmp$Treatment == "Control")
points(mds.fig, "sites", pch = 19, col = mycol[2], select = tmp$Treatment == "Irrigation")
points(mds.fig, "sites", pch = 19, col = mycol[3], select = tmp$Treatment == "Drought")
points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Control")
points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Irrigation")
points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Drought")
# pca_scores <- scores(tmp_rda)
# plot(pca_scores[,1],
#      pca_scores[,2],
#      pch=21,
#      bg=as.numeric(tmp$Treatment),
#      ylab="PCA1", xlab=("PCA2"),
#      main = doyr)
}
dev.off()
mycol <- RColorBrewer::brewer.pal(3,"Set2")
png(paste0(figure_path,"sppcomp_nmds.png"), width=6, height = 4, units = "in", res = 120)
par(mfrow=c(2,3))
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "bray")
tmp_dist <- vegdist(tmp[3:ncol(tmp)], method = "bray")
tmp_clust <- hclust(tmp_dist, method = "average")
mds.fig <- ordiplot(tmp_rda, type = "none", main = doyr)
# plot just the samples, colour by habitat, pch=19 means plot a circle
ordicluster(tmp_rda, tmp_clust, col = "gray")
points(mds.fig, "sites", pch = 19, col = mycol[1], select = tmp$Treatment == "Control")
points(mds.fig, "sites", pch = 19, col = mycol[2], select = tmp$Treatment == "Irrigation")
points(mds.fig, "sites", pch = 19, col = mycol[3], select = tmp$Treatment == "Drought")
points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Control")
points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Irrigation")
points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Drought")
# pca_scores <- scores(tmp_rda)
# plot(pca_scores[,1],
#      pca_scores[,2],
#      pch=21,
#      bg=as.numeric(tmp$Treatment),
#      ylab="PCA1", xlab=("PCA2"),
#      main = doyr)
}
dev.off()
tmp_rda$points
nmds_points <- tmp_rda$points
nmds_points <- as.data.frame(tmp_rda$points)
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
names(nmds)
names(nmds_points)
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()
ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
scale_color_brewer(palette = "Set2")
ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
scale_color_brewer(palette = "Set2")+
theme_few()
ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
theme_few()
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ggtitle(doyr)+
theme_few()
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ggtitle(doyr)+
theme_few()
gglist <- list()
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "bray")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
gglist[[doyr]] <- ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ggtitle(doyr)+
theme_few()
# tmp_dist <- vegdist(tmp[3:ncol(tmp)], method = "bray")
# tmp_clust <- hclust(tmp_dist, method = "average")
# mds.fig <- ordiplot(tmp_rda, type = "none", main = doyr)
# # plot just the samples, colour by habitat, pch=19 means plot a circle
# ordicluster(tmp_rda, tmp_clust, col = "gray")
# points(mds.fig, "sites", pch = 19, col = mycol[1], select = tmp$Treatment == "Control")
# points(mds.fig, "sites", pch = 19, col = mycol[2], select = tmp$Treatment == "Irrigation")
# points(mds.fig, "sites", pch = 19, col = mycol[3], select = tmp$Treatment == "Drought")
# points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Control")
# points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Irrigation")
# points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Drought")
# pca_scores <- scores(tmp_rda)
# plot(pca_scores[,1],
#      pca_scores[,2],
#      pch=21,
#      bg=as.numeric(tmp$Treatment),
#      ylab="PCA1", xlab=("PCA2"),
#      main = doyr)
}
# dev.off()
gglist <- list()
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "bray")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
gglist[[as.chracter(doyr)]] <- ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ggtitle(doyr)+
theme_few()
# tmp_dist <- vegdist(tmp[3:ncol(tmp)], method = "bray")
# tmp_clust <- hclust(tmp_dist, method = "average")
# mds.fig <- ordiplot(tmp_rda, type = "none", main = doyr)
# # plot just the samples, colour by habitat, pch=19 means plot a circle
# ordicluster(tmp_rda, tmp_clust, col = "gray")
# points(mds.fig, "sites", pch = 19, col = mycol[1], select = tmp$Treatment == "Control")
# points(mds.fig, "sites", pch = 19, col = mycol[2], select = tmp$Treatment == "Irrigation")
# points(mds.fig, "sites", pch = 19, col = mycol[3], select = tmp$Treatment == "Drought")
# points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Control")
# points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Irrigation")
# points(mds.fig, "sites", pch = 1, col = "grey35", select = tmp$Treatment == "Drought")
# pca_scores <- scores(tmp_rda)
# plot(pca_scores[,1],
#      pca_scores[,2],
#      pch=21,
#      bg=as.numeric(tmp$Treatment),
#      ylab="PCA1", xlab=("PCA2"),
#      main = doyr)
}
# dev.off()
gglist <- list()
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "bray")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
gglist[[as.character(doyr)]] <- ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ggtitle(doyr)+
theme_few()
}
library(gridExtra)
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
gglist <- list()
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "bray")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
gglist[[as.character(doyr)]] <- ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ggtitle(doyr)+
theme_few()+
guides(color=F)
}
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
gglist <- list()
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "bray")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
gglist[[as.character(doyr)]] <- ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ggtitle(doyr)+
theme_few()+
theme(plot.title = element_text(size=12))+
guides(color=F)
}
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
gglist <- list()
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "bray")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
gglist[[as.character(doyr)]] <- ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ggtitle(doyr)+
theme_few()+
theme(plot.title = element_text(size=10))+
guides(color=F)
}
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
gglist <- list()
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "bray")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
gglist[[as.character(doyr)]] <- ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ylab("NMDS 2")+
xlab("NMDS 1")+
ggtitle(doyr)+
theme_few()+
theme(plot.title = element_text(size=10))+
guides(color=F)
}
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
gglist <- list()
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "raup")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
gglist[[as.character(doyr)]] <- ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ylab("NMDS 2")+
xlab("NMDS 1")+
ggtitle(doyr)+
theme_few()+
theme(plot.title = element_text(size=10))+
guides(color=F)
}
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
gglist <- list()
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "cao")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
gglist[[as.character(doyr)]] <- ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ylab("NMDS 2")+
xlab("NMDS 1")+
ggtitle(doyr)+
theme_few()+
theme(plot.title = element_text(size=10))+
guides(color=F)
}
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
gglist <- list()
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "bray")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
gglist[[as.character(doyr)]] <- ggplot(nmds_points, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ylab("NMDS 2")+
xlab("NMDS 1")+
ggtitle(doyr)+
theme_few()+
theme(plot.title = element_text(size=10))+
guides(color=F)
}
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
dev.off()
dev.off()
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
png(paste0(figure_path,"sppcomp_nmds.png"), width=6, height = 4, units = "in", res = 120)
grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
dev.off()
dev.off()
dev.off()
png(paste0(figure_path,"sppcomp_nmds.png"), width=6, height = 4, units = "in", res = 120)
gout <- grid.arrange(gglist[[1]],gglist[[2]],gglist[[3]],
gglist[[4]],gglist[[5]],gglist[[6]], ncol=3, nrow=2)
print(gout)
dev.off()
nmds_df <- {}
# par(mfrow=c(2,3))
nmds_df <- {}
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "bray")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
nmds_points$Year <- doyr
nmds_df <- rdinb(nmds_df, nmds_points)
}
nmds_df <- {}
for(doyr in unique(cover_community_matrix$year)){
tmp <- filter(cover_community_matrix, year == doyr) %>% select(-year)
torm <- as.numeric(which(colSums(tmp[3:ncol(tmp)], na.rm = T) == 0)) # find spp with NA in each treatment
tmp <- tmp[,-(torm+2)] # add 2 because we lopped off two columns above
tmp_rda <- metaMDS(tmp[3:ncol(tmp)], "bray")
## Try to plot in ggplot
nmds_points <- as.data.frame(tmp_rda$points)
nmds_points$Treatment <- tmp$Treatment
nmds_points$Year <- doyr
nmds_df <- rbind(nmds_df, nmds_points)
}
ggplot(nmds_df, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ylab("NMDS 2")+
xlab("NMDS 1")+
facet_wrap("Year")+
ggtitle(doyr)+
theme_few()
ggplot(nmds_df, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ylab("NMDS 2")+
xlab("NMDS 1")+
facet_wrap("Year")+
theme_few()
ggplot(nmds_df, aes(x=MDS1, y=MDS2, color=Treatment))+
geom_point()+
geom_point(color="grey35",shape=1)+
scale_color_brewer(palette = "Set2")+
scale_y_continuous(limits=c(-2,2))+
scale_x_continuous(limits=c(-2,2))+
ylab("NMDS 2")+
xlab("NMDS 1")+
facet_wrap("Year")+
theme_few()
ggsave(paste0(figure_path,"sppcomp_nmds.png"), width=6, height = 4, units = "in", res = 120)
ggsave(paste0(figure_path,"sppcomp_nmds.png"), width=6, height = 4, units = "in", dpi = 120)
getwd()
##  usses_stability.R: R script to analyze the temporal stability of plots at
##    USSES in Idaho. Plots received irrigation/drought treatments starting
##    in 2012.
##
##  Author:       Andrew Tredennick
##  Date created: April 24, 2017
##
##  UPDATES  ###################################################################
##
##
##  ############################################################################
##  Clear the workspace
rm(list=ls(all.names = TRUE))
####
####  LOAD PACKAGES ----
####
library(tidyverse)
library(dplyr)
library(stringr)
library(ggthemes)
library(ggalt)
library(broom)
library(RColorBrewer)
library(lme4)
library(codyn)
library(vegan)
library(gridExtra)
####
####  SET DIRECTORIES; READ IN DATA ----
####
# Set working dir to source file location
setwd(dirname(rstudioapi::getActiveDocumentContext()$path)) # only works in RStudio
getwd()
source('~/Repos/usses_water/code/usses_stability.R')
source('~/Repos/usses_water/code/usses_stability.R')
